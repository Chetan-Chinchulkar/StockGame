{% extends "login/base.html" %}
{% load static %}
{% block content %}


<nav id="header-nav" class="navbar navbar-default">
  <div class="container">
    <h3 class="align">This is Round 13.</h3>
      <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" id="menu1" data-toggle="dropdown">Your purchased stocks
          <span class="caret"></span></button>
        <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
        
          <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Enigma Limited - {{ user.profile.Enigma }}</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Tec Solutions - {{ user.profile.Tec }}</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">GAAP Cinemas - {{ user.profile.GAAP }}</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">ALPHA Leisure Limited - {{ user.profile.ALPHA }}</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">LAXMI Bank Ltd. - {{ user.profile.LAXMI }}</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">CREDIT INDIA  - {{ user.profile.Punjab }}</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Lifepoint Hospitals  - {{ user.profile.Lifepoint }}</a></li>
            <li role="presentation"><a role="menuitem" tabi,ndex="-1" href="#">RIGHT Laboratories - {{ user.profile.RIGHT }}</a></li>
        </ul>
      </div>
    <h3>Money left: {{ user.profile.money }}</h3>
  </div>  
</nav>  

<!-- Timer-->
<div class="navbar-fixed-top bg-danger shadow p-2 text-center mb-5 text-white ">
  <div class="container-fluid">
    <p class="mb-0 font-weight-bold text-uppercase">Time Left</p>
    <div id="space" class="countdown pt-4"></div>
  </div>
</div>
 <!-- end -->

<!-- news -->
<div class="container">
<h1 class="display-3 align">News</h1>
<div id="carouselExampleControls" class="carousel slide align" data-ride="carousel">
  <div class="carousel-inner">

 <!-- slide1 -->

    <div class="carousel-item active">
      <div class="slide">
        <div class="blogPost--small">
          <div class="media">
            <span class="align"><a href="#"><span class="date"><span>26</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            
            <h4 class="media-heading">
              <img src="{% static 'login/new.gif' %}" alt="">
              <a href="#">US Iran tensions decreased </a>
            </h4>
            <p>
              Us Iran tensions decrease as US President Donald Trump responded to Iran's missile strikes on US forces with only sanctions, and not violence.
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->
      <div class="blogPost--small">
      <div class="media">
        <span class="pull-left"><a href="#"><span class="date"><span>25</span> <small>Jan</small></span></a></span>
        <div class="media-body">
        <h4 class="media-heading">
          <a href="#">Iran retaliates killing of its general</a>
        </h4>
        <p>
          Iran fired multiple missiles into Iraq on Tuesday evening, targeting U.S. military sites in what appeared to be retaliation for the recent American drone strike that killed one of its top generals.
        </p>
        </div>
      </div>
      </div><!-- / blogPost -->
    </div>
    </div>

    <!-- slide 2 -->

    <div class="carousel-item">
      <div class="slide">
        <div class="blogPost--small">
          <div class="media">
            <span class="pull-left"><a href="#"><span class="date"><span>24</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            <h4 class="media-heading">
              <a href="#">US killed Iran General</a>
            </h4>
            <p>
              General Qassem Soleimani, the head of Iran's elite Quds Force, has been killed in a US attack in Baghdad.  The Trump administration is struggling to explain why the US killed top Iranian general Soleimani. This increased tensions between US & Iran creating a war like situation.
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->
        <div class="blogPost--small">
          <div class="media">
            <span class="pull-left"><a href="#"><span class="date"><span>23</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            <h4 class="media-heading">
              <a href="#">Corporate tax decreased from 35% to 25%</a>
            </h4>
            <p>
              The government slashed the corporate tax rate to 22% from 30% for existing companies, and to 15% from 25% for new manufacturing companies.
              Including a surcharge and cess, the effective tax rate for existing companies would now come down to 25.17% from 35%. Companies can opt for the higher tax rates or the new ones.
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->

    </div>
    </div>

    <!-- slide 3 -->

    <div class="carousel-item">
      <div class="slide">
        <div class="blogPost--small">
          <div class="media">
            <span class="pull-left"><a href="#"><span class="date"><span>22</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            <h4 class="media-heading">
              <a href="#">RBI decreases repo rate by 25 basis points</a>
            </h4>
            <p>
              To improve Indian economy government of India decided to take different measures. As the first measure The Reserve Bank of India (RBI) reduced the repo rate. They decreased the repo rate by 25 basis points (bps) bringing it down from 6.00% to 5.75%
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->
        <div class="blogPost--small">
          <div class="media">
            <span class="pull-left"><a href="#"><span class="date"><span>21</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            <h4 class="media-heading">
              <a href="#">Indian GDP growth rate decreases</a>
            </h4>
            <p>
              Indiaâ€™s GDP growth hits over 6-year low; analysts say economy has bottomed out. Economic growth slipped further to hit an over six-year low of 4.5 per cent. GDP numbers have been declining for 7 quarters now. The previous low was recorded at 4.3 per cent in the final quarter (January-March) of 2012-13.
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->
    </div>
    </div>    

    <!-- slide 4 -->

    <div class="carousel-item">
      <div class="slide">
        <div class="blogPost--small">
          <div class="media">
            <span class="pull-left"><a href="#"><span class="date"><span>20</span> <small>Jan</small></span></a></span>
            <div class="media-body">
            <h4 class="media-heading">
              <a href="#">Rupee weakens against US Dollar</a>
            </h4>
            <p>
              The Indian rupee weakened against the US dollar tracking losses in Asian currencies as traders assess a report that said tariffs on Chinese goods will likely stay in place. In a span of 10 days rupee has changed from 71Rs/$ to 74Rs/$
            </p>
            </div>
          </div>
        </div><!-- / blogPost -->
    </div>
    </div>  

  </div>
  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div><br>
</div>

<!-- table -->
<div class="container">
  <table class="table table-dark">
    <tr>
      <th>Company</th>
      <th>Sector</th>
      <th>Category</th>
      <th>Current price</th>
    </tr>
    {% for company in companys %}
    <tr>
      <th><a href="{% url 'details' company.id %}" target="_blank">{{ company.company_name }}</a></th>
      <th>{{ company.sector }}</th>
      {% if company.cat == "Large Cap" %}
        <th><a href="#chartContainer">{{ company.cat }}</a></th>
      {% else %}
        <th><a href="#chartContainer1">{{ company.cat }}</a></th>
      {% endif %}
      <th>{{ company.price12 }}</th>
    </tr>
    {% endfor %}
  </table>
</div>

<!-- chart -->
<div class="container">
  <div id="chartContainer" class="chart padding"></div>
  <div id="chartContainer1" class="chart padding"></div>
</div>

<nav id="header-nav" class="navbar navbar-default">
  <div class="container">
    <form action="{% url 'round13' %}" method="POST">
      {% csrf_token %}
      <select name="company_id">
        {% for company in companys %}
          <option value="{{ company.id }}">{{ company.company_name }}</option>
        {% endfor %}  
      </select>
      
      <select name="what">
        <option value="buy">Buy</option>
        <option value="sell">Sell</option>
      </select>
      <label for="amount">Buy(in Rs) Or Sell(in shares) </label>
      <input type="number" name="amount" id="amount" placeholder="Enter Amount" step="0.01" min="0" required>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>  
</nav>  

<!-- Timer -->


<script>
// Set the date we're counting down to
var countDownDate = new Date("{{ date.month }} {{ date.day }}, {{ date.year }} {{ date.hour }}:{{ date.minute }}:00").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

  // Get today's date and time
  var now = new Date().getTime();
    
  // Find the distance between now and the count down date
  var distance = countDownDate - now;
    
  // Output the result in an element with id="demo"
  document.getElementById("space").innerHTML = Math.floor(distance / 1000) + "s ";
    
  // If the count down is over, write some text 
  if (distance < 0) {
    clearInterval(x);
    document.getElementById("space").innerHTML = "EXPIRED";
     window.location = "{% url 'round14' %}";
  }
}, 1000);

// chart

window.onload = function () {
 
  var large = new CanvasJS.Chart("chartContainer", {
  theme: "light2",  
  title:{
    text: "Large Cap"
  },
  axisY:[{
    title: "Stock Prices",
    includeZero: false,
    // suffix: "k"
  }],
  axisX:{
    title: "Rounds",
    includeZero: true,
  },
  toolTip: {
    shared: true
  },
  legend: {
    cursor: "pointer",
    itemclick: toggleDataSerie
  },
  data: [{
    type: "line",
    name: "Tec Solutions",
    color: "#369EAD",
    showInLegend: true,
    axisYIndex: 1,
    dataPoints: [
      { x: 0, y: {{ tec0 }} }, 
      { x: 1, y: {{ tec1 }} },
      { x: 2, y: {{ tec2 }} },
      { x: 3, y: {{ tec3 }} },
      { x: 4, y: {{ tec4 }} },
      { x: 5, y: {{ tec5 }} },
      { x: 6, y: {{ tec6 }} },
      { x: 7, y: {{ tec7 }} },
      { x: 8, y: {{ tec8 }} },
      { x: 9, y: {{ tec9 }} },
      { x: 10, y: {{ tec10 }} },
      { x: 11, y: {{ tec11 }} },
      { x: 12, y: {{ tec12 }} },
      { x: 13 },
      { x: 14 }
    ]
  },
  {
    type: "line",
    name: "LAXMI Bank Ltd.",
    color: "#C24642",
    axisYIndex: 0,
    showInLegend: true,
    dataPoints: [
      { x: 0, y: {{ lax0 }} }, 
      { x: 1, y: {{ lax1 }} },
      { x: 2, y: {{ lax2 }} },
      { x: 3, y: {{ lax3 }} },
      { x: 4, y: {{ lax4 }} },
      { x: 5, y: {{ lax5 }} },
      { x: 6, y: {{ lax6 }} },
      { x: 7, y: {{ lax7 }} },
      { x: 8, y: {{ lax8 }} },
      { x: 9, y: {{ lax9 }} },
      { x: 10, y: {{ lax10 }} },
      { x: 11, y: {{ lax11 }} },
      { x: 12, y: {{ lax12 }} },
      { x: 13 },
      { x: 14 }
    ]
  },
  {
    type: "line",
    name: "CREDIT INDIA",
    color: "#7F6084",
    axisYType: "secondary",
    showInLegend: true,
    dataPoints: [
      { x: 0, y: {{ pnb0 }} }, 
      { x: 1, y: {{ pnb1 }} },
      { x: 2, y: {{ pnb2 }} },
      { x: 3, y: {{ pnb3 }} },
      { x: 4, y: {{ pnb4 }} },
      { x: 5, y: {{ pnb5 }} },
      { x: 6, y: {{ pnb6 }} },
      { x: 7, y: {{ pnb7 }} },
      { x: 8, y: {{ pnb8 }} },
      { x: 9, y: {{ pnb9 }} },
      { x: 10, y: {{ pnb10 }} },
      { x: 11, y: {{ pnb11 }} },
      { x: 12, y: {{ pnb12 }} },
      { x: 13 },
      { x: 14 }      
    ]
  }]
});
large.render();

function toggleDataSerie(e) {
  if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
    e.dataSeries.visible = false;
  } else {
    e.dataSeries.visible = true;
  }
  e.large.render();
}

//mid
  var mid = new CanvasJS.Chart("chartContainer1", {
  theme: "light2",  
  title:{
    text: "Mid Cap"
  },
  axisY:[{
    title: "Stock Prices",
    includeZero: false,
    // suffix: "k"
  }],
  axisX:{
    title: "Rounds",
    includeZero: true,
  },
  toolTip: {
    shared: true
  },
  legend: {
    cursor: "pointer",
    itemclick: toggleDataSeries
  },
  data: [{
    type: "line",
    name: "Enigma Limited",
    color: "#663399",
    showInLegend: true,
    axisYIndex: 1,
    dataPoints: [
      { x: 0, y: {{ en0 }} }, 
      { x: 1, y: {{ en1 }} },
      { x: 2, y: {{ en2 }} },
      { x: 3, y: {{ en3 }} },
      { x: 4, y: {{ en4 }} },
      { x: 5, y: {{ en5 }} },
      { x: 6, y: {{ en6 }} },
      { x: 7, y: {{ en7 }} },
      { x: 8, y: {{ en8 }} },
      { x: 9, y: {{ en9 }} },
      { x: 10, y: {{ en10 }} },
      { x: 11, y: {{ en11 }} },
      { x: 12, y: {{ en12 }} },
      { x: 13 },
      { x: 14 }     
    ]
  },
  {
    type: "line",
    name: "GAAP Cinemas",
    color: "#DC143C",
    showInLegend: true,
    axisYIndex: 2,
    dataPoints: [
      { x: 0, y: {{ gaa0 }} }, 
      { x: 1, y: {{ gaa1 }} },
      { x: 2, y: {{ gaa2 }} },
      { x: 3, y: {{ gaa3 }} },
      { x: 4, y: {{ gaa4 }} },
      { x: 5, y: {{ gaa5 }} },
      { x: 6, y: {{ gaa6 }} },
      { x: 7, y: {{ gaa7 }} },
      { x: 8, y: {{ gaa8 }} },
      { x: 9, y: {{ gaa9 }} },
      { x: 10, y: {{ gaa10 }} },
      { x: 11, y: {{ gaa11 }} },
      { x: 12, y: {{ gaa12 }} },
      { x: 13 },
      { x: 14 }      
    ]
  },
  {
    type: "line",
    name: "ALPHA Leisure Limited",
    color: "#32CD32",
    showInLegend: true,
    axisYIndex: 3,
    dataPoints: [
      { x: 0, y: {{ alp0 }} }, 
      { x: 1, y: {{ alp1 }} },
      { x: 2, y: {{ alp2 }} },
      { x: 3, y: {{ alp3 }} },
      { x: 4, y: {{ alp4 }} },
      { x: 5, y: {{ alp5 }} },
      { x: 6, y: {{ alp6 }} },
      { x: 7, y: {{ alp7 }} },
      { x: 8, y: {{ alp8 }} },
      { x: 9, y: {{ alp9 }} },
      { x: 10, y: {{ alp10 }} },
      { x: 11, y: {{ alp11 }} },
      { x: 12, y: {{ alp12 }} },
      { x: 13 },
      { x: 14 }      
    ]
  },
  {
    type: "line",
    name: "Lifepoint Hospitals",
    color: "#D2691E",
    axisYIndex: 0,
    showInLegend: true,
    dataPoints: [
      { x: 0, y: {{ lif0 }} }, 
      { x: 1, y: {{ lif1 }} },
      { x: 2, y: {{ lif2 }} },
      { x: 3, y: {{ lif3 }} },
      { x: 4, y: {{ lif4 }} },
      { x: 5, y: {{ lif5 }} },
      { x: 6, y: {{ lif6 }} },
      { x: 7, y: {{ lif7 }} },
      { x: 8, y: {{ lif8 }} },
      { x: 9, y: {{ lif9 }} },
      { x: 10, y: {{ lif10 }} },
      { x: 11, y: {{ lif11 }} },
      { x: 12, y: {{ lif12 }} },
      { x: 13 },
      { x: 14 }      
    ]
  },
  {
    type: "line",
    name: "RIGHT Laboratories",
    color: "#40E0D0",
    // axisYType: "secondary",
    showInLegend: true,
    dataPoints: [
      { x: 0, y: {{ rig0 }} }, 
      { x: 1, y: {{ rig1 }} },
      { x: 2, y: {{ rig2 }} },
      { x: 3, y: {{ rig3 }} },
      { x: 4, y: {{ rig4 }} },
      { x: 5, y: {{ rig5 }} },
      { x: 6, y: {{ rig6 }} },
      { x: 7, y: {{ rig7 }} },
      { x: 8, y: {{ rig8 }} },
      { x: 9, y: {{ rig9 }} },
      { x: 10, y: {{ rig10 }} },
      { x: 11, y: {{ rig11 }} },
      { x: 12, y: {{ rig12 }} },
      { x: 13 },
      { x: 14 }      
    ]
  }]
});
mid.render();

function toggleDataSeries(e) {
  if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
    e.dataSeries.visible = false;
  } else {
    e.dataSeries.visible = true;
  }
  e.mid.render();
}

}
</script>

{% endblock content %}